<!--

    Copyright Â© 2020 ThingsBoard

-->
<div class="tb-absolute-fill tb-scheduler-events tb-data-table" ng-class="{'md-padding': !vm.widgetMode}" layout="column">
    <div ng-show="vm.showData" flex class="toolbarsContainer tb-scheduler-events-content"
         ng-class="{'md-whiteframe-z1': !vm.widgetMode}" layout="column">
        <md-toolbar ng-if="!vm.widgetMode" class="md-table-toolbar md-default" ng-show="!vm.selectedSchedulerEvents.length &&
                                                                  vm.query.search === null">
            <div class="md-toolbar-tools">
                <span translate>scheduler.scheduler-events</span>
                <div class="tb-scheduler-events-view-type-toolbar" layout="row" layout-align="start center">
                    <div class="tb-toolbar-button" ng-class="{'tb-selected' : vm.mode === 'list'}">
                        <md-button class="md-icon-button"
                                   ng-click="vm.mode = 'list'">
                            <md-icon class="material-icons">view_list</md-icon>
                            <md-tooltip md-direction="bottom">
                                {{'scheduler.list-mode' | translate }}
                            </md-tooltip>
                        </md-button>
                    </div>
                    <div class="tb-toolbar-button" ng-class="{'tb-selected' : vm.mode === 'calendar'}">
                        <md-button class="md-icon-button"
                                   ng-click="vm.mode = 'calendar'">
                            <md-icon class="material-icons">event</md-icon>
                            <md-tooltip md-direction="bottom">
                                {{'scheduler.calendar-mode' | translate }}
                            </md-tooltip>
                        </md-button>
                    </div>
                </div>
                <span flex></span>
                <md-button ng-if="vm.addEnabled" ng-disabled="vm.disabled" class="md-icon-button" ng-click="vm.addSchedulerEvent($event)">
                    <md-icon>add</md-icon>
                    <md-tooltip md-direction="top">
                        {{ 'scheduler.add-scheduler-event' | translate }}
                    </md-tooltip>
                </md-button>
                <md-button ng-disabled="vm.disabled" class="md-icon-button" ng-click="vm.enterFilterMode($event)">
                    <md-icon>search</md-icon>
                    <md-tooltip md-direction="top">
                        {{ 'action.search' | translate }}
                    </md-tooltip>
                </md-button>
                <md-button class="md-icon-button" ng-click="vm.reloadSchedulerEvents()">
                    <md-icon>refresh</md-icon>
                    <md-tooltip md-direction="top">
                        {{ 'action.refresh' | translate }}
                    </md-tooltip>
                </md-button>
            </div>
        </md-toolbar>
        <md-toolbar class="md-table-toolbar md-default" ng-show="!vm.selectedSchedulerEvents.length &&
                                                                  vm.query.search != null">
            <div class="md-toolbar-tools">
                <md-button class="md-icon-button" aria-label="{{ 'action.search' | translate }}">
                    <md-icon aria-label="{{ 'action.search' | translate }}" class="material-icons">search</md-icon>
                    <md-tooltip md-direction="top">
                        {{ 'scheduler.search-scheduler-events' | translate }}
                    </md-tooltip>
                </md-button>
                <md-input-container flex>
                    <label>&nbsp;</label>
                    <input ng-model="vm.query.search" class="searchInput" name="querySearchInput" placeholder="{{ 'scheduler.search-scheduler-events' | translate }}"/>
                </md-input-container>
                <md-button class="md-icon-button" aria-label="Close" ng-click="vm.exitFilterMode()">
                    <md-icon aria-label="Close" class="material-icons">close</md-icon>
                    <md-tooltip md-direction="top">
                        {{ 'action.close' | translate }}
                    </md-tooltip>
                </md-button>
            </div>
        </md-toolbar>
        <md-toolbar class="md-table-toolbar alternate" ng-show="vm.selectedSchedulerEvents.length">
            <div class="md-toolbar-tools">
                <span translate
                      translate-values="{count: vm.selectedSchedulerEvents.length}"
                      translate-interpolation="messageformat">scheduler.selected-scheduler-events</span>
                <span flex></span>
                <md-button class="md-icon-button" ng-click="vm.deleteSchedulerEvents($event)">
                    <md-icon>delete</md-icon>
                    <md-tooltip md-direction="top">
                        {{ 'action.delete' | translate }}
                    </md-tooltip>
                </md-button>
            </div>
        </md-toolbar>
        <div layout="column" flex ng-show="vm.mode === 'list'">
            <md-table-container flex>
                <table md-table md-row-select="vm.deleteEnabled" multiple="" ng-model="vm.selectedSchedulerEvents" md-progress="vm.schedulerEventsPromise">
                    <thead fix-head md-head md-order="vm.query.order" md-on-reorder="vm.onReorder">
                    <tr md-row>
                        <th ng-if="vm.displayCreatedTime" md-column md-order-by="createdTime"><span translate>scheduler.created-time</span></th>
                        <th md-column md-order-by="name"><span translate>scheduler.name</span></th>
                        <th ng-if="vm.displayType" md-column md-order-by="typeName"><span translate>scheduler.type</span></th>
                        <th ng-if="vm.displayCustomer" md-column md-order-by="assignedCustomer.title"><span translate>scheduler.created_customer</span></th>
                        <th md-column><span>&nbsp</span></th>
                    </tr>
                    </thead>
                    <tbody md-body>
                    <tr md-row md-select="schedulerEvent" md-select-id="schedulerEvent" md-auto-select ng-repeat="schedulerEvent in vm.schedulerEvents">
                        <td ng-if="vm.displayCreatedTime" md-cell>{{schedulerEvent.createdTime | date :  'yyyy-MM-dd HH:mm:ss'}}</td>
                        <td md-cell>{{schedulerEvent.name}}</td>
                        <td ng-if="vm.displayType" md-cell>{{schedulerEvent.typeName}}</td>
                        <td ng-if="vm.displayCustomer" md-cell>{{schedulerEvent.assignedCustomer.title}}</td>
                        <td md-cell class="tb-action-cell">
                            <md-button ng-if="vm.editEnabled" ng-disabled="vm.disabled" class="md-icon-button" aria-label="{{ 'action.edit' | translate }}"
                                       ng-click="vm.editSchedulerEvent($event, schedulerEvent)">
                                <md-icon aria-label="{{ 'action.edit' | translate }}" class="material-icons">edit</md-icon>
                                <md-tooltip md-direction="top">
                                    {{ 'scheduler.edit-scheduler-event' | translate }}
                                </md-tooltip>
                            </md-button>
                            <md-button ng-if="!vm.editEnabled" ng-disabled="vm.disabled" class="md-icon-button" aria-label="{{ 'action.view' | translate }}"
                                       ng-click="vm.viewSchedulerEvent($event, schedulerEvent)">
                                <md-icon aria-label="{{ 'action.view' | translate }}" class="material-icons">more_horiz</md-icon>
                                <md-tooltip md-direction="top">
                                    {{ 'scheduler.view-scheduler-event' | translate }}
                                </md-tooltip>
                            </md-button>
                            <md-button ng-if="vm.deleteEnabled" ng-disabled="vm.disabled" class="md-icon-button" aria-label="{{'action.delete' | translate}}" ng-click="vm.deleteSchedulerEvent($event, schedulerEvent)">
                                <md-icon aria-label="Delete" class="material-icons">delete</md-icon>
                                <md-tooltip md-direction="top">
                                    {{ 'scheduler.delete-scheduler-event' | translate }}
                                </md-tooltip>
                            </md-button>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <md-divider></md-divider>
                <span ng-show="!vm.schedulerEvents.length"
                      layout-align="center center"
                      class="no-data-found" translate>scheduler.no-scheduler-events</span>
            </md-table-container>
            <md-table-pagination ng-if="vm.displayPagination" md-boundary-links md-limit="vm.query.limit" md-limit-options="vm.limitOptions"
                                 md-page="vm.query.page" md-total="{{vm.schedulerEventsCount}}"
                                 md-on-paginate="vm.onPaginate" md-page-select="vm.isGtMd">
            </md-table-pagination>
        </div>
        <div class="md-padding" flex ng-show="vm.mode == 'calendar'" layout="column">
            <div layout="row">
                <h2 class="md-headline">
                    {{vm.calendarViewTitle()}}
                </h2>
                <md-input-container class="md-block" style="margin-left: 16px; margin-right: 16px;" flex>
                    <label translate>scheduler.calendar-view-type</label>
                    <md-select aria-label="{{ 'scheduler.calendar-view-type' | translate }}"
                               ng-model="vm.currentCalendarView" ng-change="vm.changeCalendarView()">
                        <md-option ng-repeat="viewType in vm.types.schedulerCalendarView" ng-value="viewType.value">
                            {{ viewType.name | translate }}
                        </md-option>
                    </md-select>
                </md-input-container>
                <div layout="row" layout-align="start center">
                    <md-button ng-disabled="vm.isCalendarToday()" class="md-raised" ng-click="vm.gotoCalendarToday()">
                        {{'scheduler.today' | translate}}
                    </md-button>
                    <md-button class="md-raised md-icon-button" aria-label="{{'scheduler.navigate-before' | translate}}" ng-click="vm.gotoCalendarPrev()">
                        <md-tooltip md-direction="top">
                            {{'scheduler.navigate-before' | translate}}
                        </md-tooltip>
                        <md-icon aria-label="{{'scheduler.navigate-before' | translate}}" class="material-icons">navigate_before</md-icon>
                    </md-button>
                    <md-button class="md-raised md-icon-button" aria-label="{{'scheduler.navigate-next' | translate}}" ng-click="vm.gotoCalendarNext()">
                        <md-tooltip md-direction="top">
                            {{'scheduler.navigate-next' | translate}}
                        </md-tooltip>
                        <md-icon aria-label="{{'scheduler.navigate-next' | translate}}" class="material-icons">navigate_next</md-icon>
                    </md-button>
                </div>
            </div>
            <md-menu flex id="tb-event-schedule-calendar-context-menu" style="position: relative;" md-position-mode="target target" tb-offset-x="-40" tb-offset-y="-45" tb-mousepoint-menu>
                <div ui-calendar="vm.calendarConfig" calendar="{{vm.calendarId}}" ng-model="vm.calendarEventSources" ng-click=""></div>
                <md-menu-content class="tb-event-schedule-calendar-menu-content" width="3" ng-mouseleave="$mdCloseMousepointMenu()">
                    <div class="tb-context-menu-header">
                        <div class="tb-context-menu-title">{{vm.contextMenuSchedulerEvent.name}}</div>
                        <div class="tb-context-menu-subtitle">{{vm.contextMenuSchedulerEvent.typeName}}</div>
                    </div>
                    <md-menu-item ng-if="vm.editEnabled">
                        <md-button ng-click="vm.editSchedulerEvent(vm.contextMenuEvent, vm.contextMenuSchedulerEvent)">
                            <md-icon md-menu-align-target aria-label="{{ 'scheduler.edit-scheduler-event' | translate }}" class="material-icons">edit</md-icon>
                            <span translate>action.edit</span>
                        </md-button>
                    </md-menu-item>
                    <md-menu-item ng-if="!vm.editEnabled">
                        <md-button ng-click="vm.viewSchedulerEvent(vm.contextMenuEvent, vm.contextMenuSchedulerEvent)">
                            <md-icon md-menu-align-target aria-label="{{ 'scheduler.view-scheduler-event' | translate }}" class="material-icons">visibility</md-icon>
                            <span translate>action.view</span>
                        </md-button>
                    </md-menu-item>
                    <md-menu-item ng-if="vm.deleteEnabled">
                        <md-button ng-click="vm.deleteSchedulerEvent(vm.contextMenuEvent, vm.contextMenuSchedulerEvent)">
                            <md-icon md-menu-align-target aria-label="{{ 'scheduler.delete-scheduler-event' | translate }}" class="material-icons">delete</md-icon>
                            <span translate>action.delete</span>
                        </md-button>
                    </md-menu-item>
                </md-menu-content>
            </md-menu>
        </div>
    </div>
    <span ng-show="!vm.showData"
          layout-align="center center"
          style="text-transform: uppercase; display: flex;"
          class="tb-absolute-fill" translate>entity.no-data</span>
</div>
